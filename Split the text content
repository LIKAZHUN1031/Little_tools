import PyPDF2

# Function to extract text from PDF and split it by letters A-Z
def split_pdf_by_letters(pdf_path, output_dir):
    # 以二进制模式打开PDF文件。创建PDF阅读器对象。 初始化一个空字符串来保存提取的文本内容。
    with open(pdf_path, "rb") as file: 
        reader = PyPDF2.PdfReader(file)
        text_content = ""
    # 使用len(reader.pages)获取PDF的页数。遍历每一页并提取文本内容。
        for page_num in range(len(reader.pages)):
            page = reader.pages[page_num]
            text_content += page.extract_text()

    # Split the text content by lines
    lines = text_content.split("\n")

    # Create dictionaries to hold content for each letter
    letter_content = {chr(i): [] for i in range(ord('A'), ord('Z') + 1)}

    # Assign lines to the corresponding letter bucket
    current_letter = None
    for line in lines:
        if len(line) > 0 and line[0].isalpha():
            first_letter = line[0].upper()
            if first_letter in letter_content:
                current_letter = first_letter
        if current_letter:
            letter_content[current_letter].append(line)

    # Write content to separate files
    for letter, content in letter_content.items():
        with open(f"{output_dir}/{letter}.txt", "w", encoding="utf-8") as f:
            f.write("\n".join(content))

# Specify the input PDF path and output directory
pdf_path = "/Users/jjlee/Desktop/PDF/（已压缩）柯林斯雅思分级词汇++初级(双层pdf).pdf"
output_dir = "/Users/jjlee/Desktop/PDF/"

# Call the function to split the PDF content
split_pdf_by_letters(pdf_path, output_dir)
